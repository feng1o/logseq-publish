- [[分布式事务与共识]]  [[两阶段提交2pc]]  [[三阶段提交]]
- [[分布式系统常见问题]]
- [[2pc或者3pc均未能解决分布式一致性问题]] #card #interview
  card-last-interval:: 4
  card-repeats:: 2
  card-ease-factor:: 2.22
  card-next-schedule:: 2024-03-02T03:33:57.017Z
  card-last-reviewed:: 2024-02-27T03:33:57.018Z
  card-last-score:: 3
- [[CAP]] #card #interview
  card-last-interval:: 4
  card-repeats:: 2
  card-ease-factor:: 2.22
  card-next-schedule:: 2023-07-25T05:07:11.260Z
  card-last-reviewed:: 2023-07-21T05:07:11.261Z
  card-last-score:: 3
	- **分布式系统最多只能同时满足一致性（Consistency）、可用性（Availability）和分区容错性（Partition tolerance）这三项中的两项** [#](https://zhuanlan.zhihu.com/p/33999708)
	- 权衡
		- CA without P：如果不要求P（不允许分区），则C（强一致性）和A（可用性）是可以保证的。但其实分区不是你想不想的问题，而是始终会存在，因此CA的系统更多的是允许分区后各子系统依然保持CA。
		  CP without A：如果不要求A（可用），相当于每个请求都需要在Server之间强一致，而P（分区）会导致同步时间无限延长，如此CP也是可以保证的。很多[[#red]]==传统的数据库分布式事务都属于这种模式==。
		  AP wihtout C：要高可用并允许分区，则需放弃一致性。一旦分区发生，节点之间可能会失去联系，为了高可用，每个节点只能用本地数据提供服务，而这样会导致全局数据的不一致性。现在[[#green]]==众多的NoSQL都属于此类。==
		- 哪个更好，也看业务场景，比如金融对C要求更高；互联网应用，一般分布式那p成了必要，否则[[SLA]]无法满足，牺牲C
-
-
- [[分布式事务]]模式和框架选型 [[分布式]]
	- [work-doc](https://{wd}/wiki/wikcnry6rNXl07bXTJpchbkpO1b?theme=LIGHT&contentTheme=DARK)  [分布式模式详见seata介绍](http://-{c2VhdGEuaW8K-/zh-cn/docs/overview/what-is-seata.html)
		- #.kanban
			- [XA](https://www.docs4dev.com/docs/zh/mysql/5.7/reference/xa.html)
				- XA是存储层实现的2PC语义，依赖于数据库对XA协议的支持
				  一阶段 prepare: TM向RM发送prepare请求，每个RM执行本地事务操作，向TM返回执行结果:
				- 二阶段 commit: 所有RM执行成功，TM发送事务提交指令二阶段
				- 优缺点:
				  优点:业务无侵入、事务资源感知分布式事务，保障全局一致性;缺点:依赖数据库协议支持、同步阻塞，TM单点故障影响可用性
			- AT
				- AT模式是一种无侵入的分布式事务解决方案，用户只需要关注业务SQL，该模式会自动对SQL执行进行拦截和代生成二阶段提交和回滚操作。理，
				  。 一阶段 prepare: 拦截SQL，保存业务数据更新前后的快照并生成数据行锁:
				  二阶段 commit: 所有分支事务执行成功，异步批量清理数据快照和行锁
				  。二阶段 rollback: 利用更新前快照回滚数据，否则人工介入处理。优缺点:
				  优点:业务无侵入、隔离性较高、几乎没有改造成本
				  缺点:依赖存储支持、适用于没有集中热点数据更新的场景;
			- TCC
				- TCC本质上是一个业务层面上的2PC，他要求业务在使用TCC模式时必须实现三个接口Try(、Confirm(和Cancel0) .
				  阶段 try 行为: 调用 自定义 的 try 逻辑，预留业务资源
				  二阶段 confirm 行为: 调用 自定义的 confirm 逻辑
				  二阶段 cancel 行为:调用 自定义的 cancel 逻辑
				  优缺点:
				  优点: Try操作资源锁定，隔离级别较高、系统吞吐量高
				  缺点: 业务侵入度高，业务接口需分拆为Try/Confirm/Cancel三个操作;
			- SAGA
				- Saga是一种松耦合、事件驱动的、可补偿的分布式事务管理方式
				  Saga由一系列子事务组成，每个子事务执行逻辑，发布消息或事件以触发下一个事务步骤。如果一个步骤失saga 会执行补偿事务来抵消前面的事务。败，
				  优缺点:
				  优点:业务侵入度适中，系统吞吐量高;
				  缺点: 需要提供补偿逻辑、事务隔离级别较低:
		- TODO 开源框架[dtm/seata(Java)](https://github.com/dtm-labs/dtm) [阿里云GTS全局事务服务](https://help.aliyun.com/document_detail/48726.html?spm=a2c4g.127.x.0.1f13797a71wTZa) >[2023-09-18 - 2023-10-31](#agenda://?start=1695024977005&end=1698740177005)
		  id:: 6667150f-36ee-4d3f-b6c7-ee667f205645
		- {{embed ((64a8227c-3415-429a-b7ad-d5f5f629a3e0))}}
- [[分布式任务编排-temporal]]
