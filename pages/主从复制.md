- MySQL 主从复制涉及到三个线程：
	- 一个在主节点的线程：`log dump thread`     **主节点会为自己的每一个从节点创建一个 log dump 线程**  读取的时候会加锁
	- 从库会生成两个线程：一个 I/O 线程，一个 SQL 线程
- 主库会生成一个 log dump 线程,用来给从库 I/O 线程传 Binlog 数据。
- 从库的 I/O 线程会去请求主库的 [[Binlog]]，并将得到的 Binlog 写到本地的 [[relay log]] (中继日志)文件中。
- SQL 线程,会读取[[relay log]]  文件中的日志，并解析成 SQL 语句逐一执行。  从服务器 I/O 线程将主服务器的 Binlog 日志读取过来，解析到各类 Events 之后记录到从服务器本地文件，这个文件就被称为 relay log
-
- seconds_behind_master 的计算方法是这样的：
	- 每个事务的 binlog 里面都有一个时间字段，用于记录主库上写入的时间；备库取出当前正在执行的事务的时间字段的值，计算它与当前系统时间的差值，得到 seconds_behind_master。
	- 如果主备库机器的系统时间设置不一致，会不会导致主备延迟的值不准？其实不会的。因为，备库连接到主库的时候，会通过执行 SELECT UNIX_TIMESTAMP() 函数来获得当前主库的系统时间。如果这时候发现主库的系统时间与自己不一致，备库在执行 seconds_behind_master 计算的时候会自动扣掉这个差值。
- 主备复制延迟原因
	- 备库性能问题   读多
	- 大事务 DDL操作， 没开[并行复制](https://time.geekbang.org/column/article/76161)能力
-
- {{embed ((640b0816-44e8-4087-9815-74fcb25c815e))}}